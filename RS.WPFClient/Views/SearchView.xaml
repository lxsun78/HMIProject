<UserControl
    x:Class="RS.WPFClient.Views.SearchView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:behavior="clr-namespace:RS.WPFClient.Behaviors"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:local="clr-namespace:RS.WPFClient.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:model="clr-namespace:RS.WPFClient.Models"
    xmlns:rs="https://github.com/luo-ross/MultiVerseKit"
    xmlns:viewModel="clr-namespace:RS.WPFClient.ViewModels"
    d:DataContext="{d:DesignInstance Type=viewModel:SearchViewModel}"
    d:DesignWidth="800"
    mc:Ignorable="d">
    <i:Interaction.Behaviors>
        <behavior:SearchViewBehavior HideSearchCommand="{Binding HideSearchCommand, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
    </i:Interaction.Behaviors>
    <Grid>
        <Border Grid.Column="0" CornerRadius="10">
            <Border.Style>
                <Style TargetType="{x:Type Border}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsSearchChecked, UpdateSourceTrigger=PropertyChanged}" Value="False">
                            <Setter Property="Background" Value="#DBE3ED" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding IsSearchChecked, UpdateSourceTrigger=PropertyChanged}" Value="True">
                            <Setter Property="Background" Value="#FFFFFF" />
                            <Setter Property="BorderBrush" Value="#0F7AF5" />
                            <Setter Property="BorderThickness" Value="1" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Path
                    Grid.Column="0"
                    Width="16"
                    Height="16"
                    Margin="10,0,0,0"
                    HorizontalAlignment="Left"
                    Data="{StaticResource RSApp.Icons.Search}"
                    Fill="#515151"
                    Stretch="Fill">
                    <Path.Style>
                        <Style TargetType="{x:Type Path}">
                            <Setter Property="Visibility" Value="Visible" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsSearchChecked, UpdateSourceTrigger=PropertyChanged}" Value="True">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Path.Style>
                </Path>
                <ToggleButton
                    x:Name="PART_SearchType"
                    Grid.Column="0"
                    Margin="0"
                    VerticalAlignment="Stretch"
                    rs:ControlsHelper.CornerRadius="10,0,0,10">
                    <ToggleButton.Style>
                        <Style BasedOn="{StaticResource RSApp.Styles.ButtonBase}" TargetType="{x:Type ToggleButton}">
                            <Setter Property="Background" Value="#F3F4F6" />
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Setter Property="IsChecked" Value="{Binding IsSearchTypeChecked}" />
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#E8EAEE" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter Property="Background" Value="#D1DAE4" />
                                </Trigger>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter Property="Background" Value="#DCE0E5" />
                                </Trigger>
                                <DataTrigger Binding="{Binding IsSearchChecked, UpdateSourceTrigger=PropertyChanged}" Value="True">
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ToggleButton.Style>
                    <StackPanel Orientation="Horizontal">
                        <Path
                            Grid.Column="0"
                            Width="16"
                            Height="16"
                            Margin="10,0,0,0"
                            HorizontalAlignment="Left"
                            Data="{StaticResource RSApp.Icons.Search}"
                            Fill="#515151"
                            Stretch="Fill" />
                        <TextBlock
                            Margin="10,0,0,0"
                            FontSize="14"
                            Foreground="#333333"
                            Text="邮件" />
                        <Path
                            Grid.Column="0"
                            Width="8"
                            Height="5"
                            Margin="5,0,5,0"
                            HorizontalAlignment="Left"
                            Data="{StaticResource RSApp.Icons.DownArrow}"
                            Fill="#515151"
                            Stretch="Fill" />
                    </StackPanel>
                </ToggleButton>
                <TextBox
                    x:Name="PART_TxtSearch"
                    Grid.Column="1"
                    Margin="8,0,0,0"
                    rs:TextBoxHelper.Watermark="搜索"
                    Background="Transparent"
                    BorderBrush="Transparent"
                    BorderThickness="0"
                    CaretBrush="{Binding ElementName=PART_SearchChecked, Path=BorderBrush}"
                    FontSize="14"
                    Text="{Binding SearchContent}">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Loaded">
                            <i:InvokeCommandAction Command="{Binding TxtSearchLoadedCommand}" />
                        </i:EventTrigger>
                        <i:EventTrigger EventName="GotFocus">
                            <i:InvokeCommandAction Command="{Binding TxtSearchGotFocusCommand}" />
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </TextBox>
            </Grid>
        </Border>
        <rs:RSPopup
            x:Name="PART_SearchPopup"
            AllowsTransparency="True"
            Focusable="False"
            HorizontalOffset="-3"
            IsOpen="{Binding ElementName=PART_SearchType, Path=IsChecked, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
            Placement="Bottom"
            PlacementTarget="{Binding ElementName=PART_SearchType}"
            PopupAnimation="None"
            SnapsToDevicePixels="True"
            StaysOpen="False"
            VerticalOffset="-3">
            <Border Margin="15" Effect="{StaticResource RSApp.Styles.DefaultEffect}">
                <Border
                    x:Name="DropDownBorder"
                    Width="200"
                    Margin="5"
                    Padding="5"
                    Background="#FFF"
                    CornerRadius="5">
                    <ItemsControl ItemsSource="{Binding SearchTypeModelList}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel IsItemsHost="True" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate DataType="{x:Type model:SearchTypeModel}">
                                <Border
                                    x:Name="PART_Border"
                                    Padding="15,5,15,5"
                                    CornerRadius="5">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="" />
                                    </i:Interaction.Triggers>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            FontSize="14"
                                            Foreground="#333333"
                                            Text="{Binding TypeDes}" />
                                    </Grid>
                                </Border>
                                <DataTemplate.Triggers>
                                    <Trigger SourceName="PART_Border" Property="IsMouseOver" Value="True">
                                        <Setter TargetName="PART_Border" Property="Background" Value="#F3F4F6" />
                                        <Setter TargetName="PART_Border" Property="Cursor" Value="Hand" />
                                    </Trigger>
                                    <Trigger SourceName="PART_Border" Property="IsMouseOver" Value="False">
                                        <Setter TargetName="PART_Border" Property="Background" Value="Transparent" />
                                    </Trigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Border>
            </Border>
        </rs:RSPopup>
    </Grid>
</UserControl>
